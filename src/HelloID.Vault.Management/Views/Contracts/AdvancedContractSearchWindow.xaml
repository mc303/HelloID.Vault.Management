<Window x:Class="HelloID.Vault.Management.Views.Contracts.AdvancedContractSearchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:vm="clr-namespace:HelloID.Vault.Management.ViewModels.Contracts"
        Title="Advanced Search - Contract"
        Width="900" Height="600"
        WindowStartupLocation="CenterOwner"
        ui:WindowHelper.UseModernWindowStyle="True">

    <Window.Resources>
        <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>
        <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="Advanced Search - Contract"
                   FontSize="20"
                   FontWeight="SemiBold"
                   Margin="0,0,0,20"/>

        <!-- Filter List -->
        <Border Grid.Row="1"
                BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                BorderThickness="1"
                Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                CornerRadius="4">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding Filters}" Margin="16">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="0,0,0,12" Margin="0,0,0,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="250"/>
                                        <ColumnDefinition Width="150"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Field Selector -->
                                    <ComboBox Grid.Column="0"
                                              ItemsSource="{Binding DataContext.AvailableFields, RelativeSource={RelativeSource AncestorType=Window}}"
                                              SelectedValuePath="FieldName"
                                              DisplayMemberPath="DisplayName"
                                              SelectedValue="{Binding FieldName, Mode=TwoWay}"
                                              Margin="0,0,8,0"/>

                                    <!-- Operator Selector -->
                                    <ComboBox Grid.Column="1"
                                              ItemsSource="{Binding DataContext.AvailableOperators, RelativeSource={RelativeSource AncestorType=Window}}"
                                              SelectedItem="{Binding Operator, Mode=TwoWay}"
                                              Margin="0,0,8,0"/>

                                    <!-- Value Input -->
                                    <TextBox Grid.Column="2"
                                             Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             ui:ControlHelper.PlaceholderText="Enter filter value..."
                                             Margin="0,0,8,0"/>

                                    <!-- Remove Button -->
                                    <Button Grid.Column="3"
                                            Content="Remove"
                                            Command="{Binding DataContext.RemoveFilterCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"
                                            Padding="12,6"
                                            Style="{StaticResource AccentButtonStyle}"
                                            Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                                            Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- Action Buttons -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Add Filter Button -->
            <Button Grid.Column="0"
                    Content="Add Filter"
                    Command="{Binding AddFilterCommand}"
                    Padding="16,8"
                    Margin="0,0,8,0"/>

            <!-- Clear All Button -->
            <Button Grid.Column="2"
                    Content="Clear All"
                    Command="{Binding ClearAllCommand}"
                    Padding="16,8"
                    Margin="0,0,8,0"/>

            <!-- Apply Filters Button -->
            <Button Grid.Column="3"
                    Content="Apply Filters"
                    Command="{Binding ApplyFiltersCommand}"
                    Style="{StaticResource AccentButtonStyle}"
                    Padding="16,8"
                    Margin="0,0,8,0"/>

            <!-- Close Button -->
            <Button Grid.Column="4"
                    Content="Close"
                    Command="{Binding CloseCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                    Padding="16,8"/>
        </Grid>
    </Grid>
</Window>
